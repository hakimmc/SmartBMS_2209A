\doxysection{src/\+Can.c File Reference}
\label{_can_8c}\index{src/Can.c@{src/Can.c}}


CAN driver implementation for the ESP32 using the TWAI driver.  


{\ttfamily \#include "{}Can.\+h"{}}\newline
{\ttfamily \#include "{}d2cc\+\_\+lib.\+h"{}}\newline
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
uint8\+\_\+t \textbf{ Can\+\_\+\+Init} (twai\+\_\+general\+\_\+config\+\_\+t can\+\_\+gpio\+\_\+config, twai\+\_\+timing\+\_\+config\+\_\+t can\+\_\+time\+\_\+config, twai\+\_\+filter\+\_\+config\+\_\+t can\+\_\+filter\+\_\+config)
\begin{DoxyCompactList}\small\item\em Initializes the CAN (TWAI) driver with the specified configurations. \end{DoxyCompactList}\item 
uint8\+\_\+t \textbf{ Can\+\_\+\+Transmit} (twai\+\_\+message\+\_\+t message, uint8\+\_\+t data[$\,$])
\begin{DoxyCompactList}\small\item\em Transmits a CAN message with the specified data. \end{DoxyCompactList}\item 
void \textbf{ Can\+Reporter} (void $\ast$pv\+Parameter)
\begin{DoxyCompactList}\small\item\em Task function to periodically report CAN messages. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\textbf{ Dbc\+Struct} \textbf{ maindbc\+\_\+struct}
\begin{DoxyCompactList}\small\item\em Structure to hold CAN message data. \end{DoxyCompactList}\item 
twai\+\_\+message\+\_\+t \textbf{ Can\+\_\+\+Main} = \{.extd = 0, .rtr = 0, .ss = 0, .self = 0, .dlc\+\_\+non\+\_\+comp = 0, .identifier = \textbf{ Can\+\_\+\+Main\+\_\+\+ID}, .data\+\_\+length\+\_\+code = 8, .data = \{0\},\}
\item 
twai\+\_\+message\+\_\+t \textbf{ Battery\+\_\+\+Messages} = \{.extd = 0, .rtr = 0, .ss = 0, .self = 0, .dlc\+\_\+non\+\_\+comp = 0, .identifier = \textbf{ Battery\+\_\+\+Messages\+\_\+\+ID}, .data\+\_\+length\+\_\+code = 8, .data = \{0\},\}
\item 
twai\+\_\+message\+\_\+t \textbf{ Battery\+\_\+\+Voltages} = \{.extd = 0, .rtr = 0, .ss = 0, .self = 0, .dlc\+\_\+non\+\_\+comp = 0, .identifier = \textbf{ Can\+\_\+\+Battery\+\_\+\+Voltages\+\_\+\+ID}, .data\+\_\+length\+\_\+code = 8, .data = \{0\},\}
\item 
twai\+\_\+message\+\_\+t \textbf{ Battery\+\_\+\+Temperatures} = \{.extd = 0, .rtr = 0, .ss = 0, .self = 0, .dlc\+\_\+non\+\_\+comp = 0, .identifier = \textbf{ Can\+\_\+\+Battery\+\_\+\+Temperatures\+\_\+\+ID}, .data\+\_\+length\+\_\+code = 8, .data = \{0\},\}
\item 
uint8\+\_\+t \textbf{ Data\+\_\+\+Of\+\_\+\+Can\+\_\+\+Main} [8] = \{0, 1, 2, 3, 4, 5, 6, 7\}
\item 
uint8\+\_\+t \textbf{ Data\+\_\+\+Of\+\_\+\+Battery\+\_\+\+Messages} [8] = \{8, 9, 10, 11, 12, 13, 14, 15\}
\item 
uint8\+\_\+t \textbf{ Data\+\_\+\+Of\+\_\+\+Battery\+\_\+\+Voltages} [8] = \{16, 17, 22, 32, 42, 52, 62, 72\}
\item 
uint8\+\_\+t \textbf{ Data\+\_\+\+Of\+\_\+\+Battery\+\_\+\+Temperatures} [8] = \{35, 13, 23, 33, 43, 53, 63, 73\}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
CAN driver implementation for the ESP32 using the TWAI driver. 

\begin{DoxyDate}{Date}
18 December 2024 
\end{DoxyDate}
\begin{DoxyAuthor}{Author}
hakimmc 
\end{DoxyAuthor}


\doxysubsection{Function Documentation}
\index{Can.c@{Can.c}!Can\_Init@{Can\_Init}}
\index{Can\_Init@{Can\_Init}!Can.c@{Can.c}}
\doxysubsubsection{Can\_Init()}
{\footnotesize\ttfamily \label{_can_8c_a8920d0f7ab8095cccb447da8d5fae390} 
uint8\+\_\+t Can\+\_\+\+Init (\begin{DoxyParamCaption}\item[{twai\+\_\+general\+\_\+config\+\_\+t}]{can\+\_\+gpio\+\_\+config}{, }\item[{twai\+\_\+timing\+\_\+config\+\_\+t}]{can\+\_\+time\+\_\+config}{, }\item[{twai\+\_\+filter\+\_\+config\+\_\+t}]{can\+\_\+filter\+\_\+config}{}\end{DoxyParamCaption})}



Initializes the CAN (TWAI) driver with the specified configurations. 

Initializes the CAN interface.


\begin{DoxyParams}{Parameters}
{\em can\+\_\+gpio\+\_\+config} & General configuration for the CAN GPIO pins and mode. \\
\hline
{\em can\+\_\+time\+\_\+config} & Timing configuration for the CAN bus (e.\+g., bitrate). \\
\hline
{\em can\+\_\+filter\+\_\+config} & Filter configuration for message acceptance. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
uint8\+\_\+t Returns 1 if the driver is successfully initialized. 
\end{DoxyReturn}
\index{Can.c@{Can.c}!Can\_Transmit@{Can\_Transmit}}
\index{Can\_Transmit@{Can\_Transmit}!Can.c@{Can.c}}
\doxysubsubsection{Can\_Transmit()}
{\footnotesize\ttfamily \label{_can_8c_a51dc04f4c5f5a544e73c33e2d606193b} 
uint8\+\_\+t Can\+\_\+\+Transmit (\begin{DoxyParamCaption}\item[{twai\+\_\+message\+\_\+t}]{message}{, }\item[{uint8\+\_\+t}]{data}{[$\,$]}\end{DoxyParamCaption})}



Transmits a CAN message with the specified data. 

Transmits a CAN message.


\begin{DoxyParams}{Parameters}
{\em message} & The CAN message structure to transmit. \\
\hline
{\em data} & The data array to be sent with the message. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
uint8\+\_\+t Returns 1 if the transmission is successful. 
\end{DoxyReturn}
\index{Can.c@{Can.c}!CanReporter@{CanReporter}}
\index{CanReporter@{CanReporter}!Can.c@{Can.c}}
\doxysubsubsection{CanReporter()}
{\footnotesize\ttfamily \label{_can_8c_a99ef09684458d26b79a4185bc0af934b} 
void Can\+Reporter (\begin{DoxyParamCaption}\item[{void $\ast$}]{pv\+Parameter}{}\end{DoxyParamCaption})}



Task function to periodically report CAN messages. 

Task to report CAN messages.

This function initializes the CAN driver and repeatedly transmits preconfigured CAN messages, using data from the {\ttfamily \doxyref{Dbc\+Struct}{p.}{struct_dbc_struct}}.


\begin{DoxyParams}{Parameters}
{\em pv\+Parameter} & A pointer to any parameters passed to the task (unused). \\
\hline
\end{DoxyParams}


\doxysubsection{Variable Documentation}
\index{Can.c@{Can.c}!Battery\_Messages@{Battery\_Messages}}
\index{Battery\_Messages@{Battery\_Messages}!Can.c@{Can.c}}
\doxysubsubsection{Battery\_Messages}
{\footnotesize\ttfamily \label{_can_8c_a130a3010e507b1482a7aeb97e8b3fcc2} 
twai\+\_\+message\+\_\+t Battery\+\_\+\+Messages = \{.extd = 0, .rtr = 0, .ss = 0, .self = 0, .dlc\+\_\+non\+\_\+comp = 0, .identifier = \textbf{ Battery\+\_\+\+Messages\+\_\+\+ID}, .data\+\_\+length\+\_\+code = 8, .data = \{0\},\}}

\index{Can.c@{Can.c}!Battery\_Temperatures@{Battery\_Temperatures}}
\index{Battery\_Temperatures@{Battery\_Temperatures}!Can.c@{Can.c}}
\doxysubsubsection{Battery\_Temperatures}
{\footnotesize\ttfamily \label{_can_8c_aeac6d1745e019aac057f6d092866ff46} 
twai\+\_\+message\+\_\+t Battery\+\_\+\+Temperatures = \{.extd = 0, .rtr = 0, .ss = 0, .self = 0, .dlc\+\_\+non\+\_\+comp = 0, .identifier = \textbf{ Can\+\_\+\+Battery\+\_\+\+Temperatures\+\_\+\+ID}, .data\+\_\+length\+\_\+code = 8, .data = \{0\},\}}

\index{Can.c@{Can.c}!Battery\_Voltages@{Battery\_Voltages}}
\index{Battery\_Voltages@{Battery\_Voltages}!Can.c@{Can.c}}
\doxysubsubsection{Battery\_Voltages}
{\footnotesize\ttfamily \label{_can_8c_affc81c163d004c727041b42b732420f3} 
twai\+\_\+message\+\_\+t Battery\+\_\+\+Voltages = \{.extd = 0, .rtr = 0, .ss = 0, .self = 0, .dlc\+\_\+non\+\_\+comp = 0, .identifier = \textbf{ Can\+\_\+\+Battery\+\_\+\+Voltages\+\_\+\+ID}, .data\+\_\+length\+\_\+code = 8, .data = \{0\},\}}

\index{Can.c@{Can.c}!Can\_Main@{Can\_Main}}
\index{Can\_Main@{Can\_Main}!Can.c@{Can.c}}
\doxysubsubsection{Can\_Main}
{\footnotesize\ttfamily \label{_can_8c_a5ac86e7553816a53c292e55c741953bb} 
twai\+\_\+message\+\_\+t Can\+\_\+\+Main = \{.extd = 0, .rtr = 0, .ss = 0, .self = 0, .dlc\+\_\+non\+\_\+comp = 0, .identifier = \textbf{ Can\+\_\+\+Main\+\_\+\+ID}, .data\+\_\+length\+\_\+code = 8, .data = \{0\},\}}

\index{Can.c@{Can.c}!Data\_Of\_Battery\_Messages@{Data\_Of\_Battery\_Messages}}
\index{Data\_Of\_Battery\_Messages@{Data\_Of\_Battery\_Messages}!Can.c@{Can.c}}
\doxysubsubsection{Data\_Of\_Battery\_Messages}
{\footnotesize\ttfamily \label{_can_8c_aa0ee0676a6100daf2b3b1aad623bd07b} 
uint8\+\_\+t Data\+\_\+\+Of\+\_\+\+Battery\+\_\+\+Messages[8] = \{8, 9, 10, 11, 12, 13, 14, 15\}}

\index{Can.c@{Can.c}!Data\_Of\_Battery\_Temperatures@{Data\_Of\_Battery\_Temperatures}}
\index{Data\_Of\_Battery\_Temperatures@{Data\_Of\_Battery\_Temperatures}!Can.c@{Can.c}}
\doxysubsubsection{Data\_Of\_Battery\_Temperatures}
{\footnotesize\ttfamily \label{_can_8c_a6674195f29972ad81603995168dbe0d3} 
uint8\+\_\+t Data\+\_\+\+Of\+\_\+\+Battery\+\_\+\+Temperatures[8] = \{35, 13, 23, 33, 43, 53, 63, 73\}}

\index{Can.c@{Can.c}!Data\_Of\_Battery\_Voltages@{Data\_Of\_Battery\_Voltages}}
\index{Data\_Of\_Battery\_Voltages@{Data\_Of\_Battery\_Voltages}!Can.c@{Can.c}}
\doxysubsubsection{Data\_Of\_Battery\_Voltages}
{\footnotesize\ttfamily \label{_can_8c_a1f5180759945949348fed4c7a0bb56db} 
uint8\+\_\+t Data\+\_\+\+Of\+\_\+\+Battery\+\_\+\+Voltages[8] = \{16, 17, 22, 32, 42, 52, 62, 72\}}

\index{Can.c@{Can.c}!Data\_Of\_Can\_Main@{Data\_Of\_Can\_Main}}
\index{Data\_Of\_Can\_Main@{Data\_Of\_Can\_Main}!Can.c@{Can.c}}
\doxysubsubsection{Data\_Of\_Can\_Main}
{\footnotesize\ttfamily \label{_can_8c_ad097fc803847532903674508f4286a2f} 
uint8\+\_\+t Data\+\_\+\+Of\+\_\+\+Can\+\_\+\+Main[8] = \{0, 1, 2, 3, 4, 5, 6, 7\}}

\index{Can.c@{Can.c}!maindbc\_struct@{maindbc\_struct}}
\index{maindbc\_struct@{maindbc\_struct}!Can.c@{Can.c}}
\doxysubsubsection{maindbc\_struct}
{\footnotesize\ttfamily \label{_can_8c_adabf6670e12fa284be00ec7af178f57d} 
\textbf{ Dbc\+Struct} maindbc\+\_\+struct\hspace{0.3cm}{\ttfamily [extern]}}



Structure to hold CAN message data. 

